{
  "version": 3,
  "sources": ["../../../../app/routes/admin+/users.tsx", "../../../../app/components/search-bar.tsx"],
  "sourcesContent": ["// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app/routes/admin+/users.tsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app/routes/admin+/users.tsx\");\n  import.meta.hot.lastModified = \"1704639630681.535\";\n}\n// REMIX HMR END\n\nimport { json, redirect } from \"@remix-run/node\";\nimport { Link, useLoaderData } from \"@remix-run/react\";\nimport { z } from \"zod\";\nimport { GeneralErrorBoundary } from \"#app/components/error-boundary.tsx\";\nimport { ErrorList } from \"#app/components/forms.tsx\";\nimport { SearchBar } from \"#app/components/search-bar.tsx\";\nimport { prisma } from \"#app/utils/db/db.server\";\nimport { cn, getUserImgSrc, useDelayedIsPending } from \"#app/utils/misc.tsx\";\nconst UserSearchResultSchema = z.object({\n  id: z.string(),\n  username: z.string(),\n  name: z.string().nullable(),\n  imageId: z.string().nullable()\n});\nconst UserSearchResultsSchema = z.array(UserSearchResultSchema);\n_c = UserSearchResultsSchema;\nexport async function loader({\n  request\n}) {\n  const searchTerm = new URL(request.url).searchParams.get(\"search\");\n  if (searchTerm === \"\") {\n    return redirect(\"/users\");\n  }\n  const like = `%${searchTerm ?? \"\"}%`;\n  const rawUsers = await prisma.$queryRaw`\n\t\tSELECT User.id, User.username, User.name, UserImage.id AS imageId\n\t\tFROM User\n\t\tLEFT JOIN UserImage ON User.id = UserImage.userId\n\t\tWHERE User.username LIKE ${like}\n\t\tOR User.name LIKE ${like}\n\t\tORDER BY (\n\t\t\tSELECT Note.updatedAt\n\t\t\tFROM Note\n\t\t\tWHERE Note.ownerId = User.id\n\t\t\tORDER BY Note.updatedAt DESC\n\t\t\tLIMIT 1\n\t\t) DESC\n\t\tLIMIT 50\n\t`;\n  const result = UserSearchResultsSchema.safeParse(rawUsers);\n  if (!result.success) {\n    return json({\n      status: \"error\",\n      error: result.error.message\n    }, {\n      status: 400\n    });\n  }\n  return json({\n    status: \"idle\",\n    users: result.data\n  });\n}\nexport default function UsersRoute() {\n  _s();\n  const data = useLoaderData();\n  const isPending = useDelayedIsPending({\n    formMethod: \"GET\",\n    formAction: \"/users\"\n  });\n  if (data.status === \"error\") {\n    console.error(data.error);\n  }\n  return <div className=\"container mb-48 mt-36 flex flex-col items-center justify-center gap-6\">\n      <h1 className=\"text-h1\">Epic Notes Users</h1>\n      <div className=\"w-full max-w-[700px] \">\n        <SearchBar autoSubmit status={data.status} />\n      </div>\n      <main>\n        {data.status === \"idle\" ? data.users.length ? <ul className={cn(\"flex w-full flex-wrap items-center justify-center gap-4 delay-200\", {\n        \"opacity-50\": isPending\n      })}>\n              {data.users.map(user => <li key={user.id}>\n                  <Link className=\"flex h-36 w-44 flex-col items-center justify-center rounded-lg bg-muted px-5 py-3\" to={user.username}>\n                    <img alt={user.name ?? user.username} className=\"h-16 w-16 rounded-full\" src={getUserImgSrc(user.imageId)} />\n                    {user.name ? <span className=\"w-full truncate text-center text-body-md\">\n                        {user.name}\n                      </span> : null}\n                    <span className=\"w-full overflow-hidden text-ellipsis text-center text-body-sm text-muted-foreground\">\n                      {user.username}\n                    </span>\n                  </Link>\n                </li>)}\n            </ul> : <p>No users found</p> : data.status === \"error\" ? <ErrorList errors={[\"There was an error parsing the results\"]} /> : null}\n      </main>\n    </div>;\n}\n_s(UsersRoute, \"X4KRWZR4FN6itrOq+aVkJ8n94s8=\", false, function () {\n  return [useLoaderData, useDelayedIsPending];\n});\n_c2 = UsersRoute;\nexport function ErrorBoundary() {\n  return <GeneralErrorBoundary />;\n}\n_c3 = ErrorBoundary;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"UserSearchResultsSchema\");\n$RefreshReg$(_c2, \"UsersRoute\");\n$RefreshReg$(_c3, \"ErrorBoundary\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;", "// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app/components/search-bar.tsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app/components/search-bar.tsx\");\n  import.meta.hot.lastModified = \"1713736572363.7344\";\n}\n// REMIX HMR END\n\nimport { Form, useSearchParams, useSubmit } from \"@remix-run/react\";\nimport { useId } from \"react\";\nimport { useDebounce, useIsPending } from \"#app/utils/misc.tsx\";\nimport { Icon } from \"./ui/icon.tsx\";\nimport { Input } from \"./ui/input.tsx\";\nimport { Label } from \"./ui/label.tsx\";\nimport { StatusButton } from \"./ui/status-button.tsx\";\nexport function SearchBar({\n  status,\n  autoFocus = false,\n  autoSubmit = false\n}) {\n  _s();\n  const id = useId();\n  const [searchParams] = useSearchParams();\n  const submit = useSubmit();\n  const isSubmitting = useIsPending({\n    formMethod: \"GET\",\n    formAction: \"/users\"\n  });\n  const handleFormChange = useDebounce(form => {\n    submit(form);\n  }, 400);\n  return <Form action=\"/users\" className=\"flex flex-wrap items-center justify-center gap-2\" method=\"GET\" onChange={e => autoSubmit && handleFormChange(e.currentTarget)}>\n      <div className=\"flex-1\">\n        <Label className=\"sr-only\" htmlFor={id}>\n          Search\n        </Label>\n        <Input\n      // Autofocus will be handled by the consumers\n      // By default, it's disabled, so no a11y issues here\n      // eslint-disable-next-line jsx-a11y/no-autofocus\n      autoFocus={autoFocus} className=\"w-full\" defaultValue={searchParams.get(\"search\") ?? \"\"} id={id} name=\"search\" placeholder=\"Search\" type=\"search\" />\n      </div>\n      <div>\n        <StatusButton className=\"flex w-full items-center justify-center\" status={isSubmitting ? \"pending\" : status} type=\"submit\">\n          <Icon name=\"magnifying-glass\" />\n          <span className=\"sr-only\">Search</span>\n        </StatusButton>\n      </div>\n    </Form>;\n}\n_s(SearchBar, \"67w/u/H51SOczxnmNINjhY9bY4o=\", false, function () {\n  return [useId, useSearchParams, useSubmit, useIsPending, useDebounce];\n});\n_c = SearchBar;\nvar _c;\n$RefreshReg$(_c, \"SearchBar\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;"],
  "mappings": "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",
  "names": ["import_react", "import_jsx_dev_runtime", "_s", "_c", "_s", "_c2", "_c"]
}
